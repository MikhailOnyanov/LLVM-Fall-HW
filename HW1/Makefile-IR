LLVM_CLANG := clang
CSTD       := -std=c99
INCLUDES   := -I.

LOGIC_SRC := app.c

# Карта "цель -> флаги оптимизации"
app_O1.ll app_O1.bc: OPT := -O1
app_Os.ll app_Os.bc: OPT := -Os

IR_O1  : app_O1.ll
IR_Os  : app_Os.ll
BC_O1  : app_O1.bc
BC_Os  : app_Os.bc

# Правило для .ll
app_%.ll: 
	$(LLVM_CLANG) $(CSTD) $(INCLUDES) -S -emit-llvm $(OPT) $(LOGIC_SRC) -o $@

# Правило для .bc
app_%.bc: 
	$(LLVM_CLANG) $(CSTD) $(INCLUDES) -c -emit-llvm $(OPT) $(LOGIC_SRC) -o $@
